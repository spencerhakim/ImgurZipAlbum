location.hostname==="imgur.com"&&function(a){function j(a){for(var b=1,c=arguments.length;b<c;b++)a=a.replace("%"+b,arguments[b]);return a}console||(console=console||{},console.log=function(){});var b=a("div[id^=album-].nodisplay");if(b.length===0){alert("Hey, this isn't an album!");return}var c="http://spencerhakim.github.com/ImgurZipAlbum/",d=".jpg",e=50,f=d===".jpg"?"image/jpeg":"image/png",g='<div class="panel" style="display:inline-block; position:fixed; bottom:0; padding:10px; z-index:+1001"><div class="textbox"><img src="%1media/loader.gif" style="vertical-align:text-bottom" /> <span id="IZAstatus"></span></div></div>';g=j(g,c);var h='<div class="panel" style="display:inline-block; position:fixed; bottom:0; right:0; padding:10px; z-index:+1001"><div class="textbox"><span style="font-weight:bold; color:red">Failed images</span><ul id="IZAerrors" style="list-style-position:inside"></ul></div></div>',i='<span class="stat">%1</span> of <span class="stat">%2</span> images downloaded...',k=function(){function k(){setTimeout(function(b){var c=a(b).data("imgur-id"),e=atob(l(b));r.file(c+d,e,{base64:!1,binary:!0}),console.log(j("Succesful: %1, %2kB",c,(e.length/1024).toFixed(2))),n()},e,this)}function l(a){var b=document.createElement("canvas");b.width=a.width,b.height=a.height;var c=b.getContext("2d");c.drawImage(a,0,0);var d=b.toDataURL(f,.95);return d.replace(/^data:image\/(png|jpg|jpeg);base64,/,"")}function m(){setTimeout(function(b){var c=a(b).data("imgur-id");p=a(p).not([c]).get(),q.push(c),console.log("Failed: "+c);var d={};(d=a("#IZAerrors")).length===0&&a(window.body).append(a(h)),d.append(j('<li><a href="http://imgur.com/download/%1">%1</a></li>',c)),a(j("[id$=%1] img, img[id$=%1]",c)).css("outline","3px solid red"),n()},e,this)}function n(){var a=Object.keys(r.files).length;s.html(j(i,a,p.length)),a===p.length&&(console.log("Generating zip..."),s.html("Generating zip..."),s=s.closest(".panel"),s.downloadify({filename:o+".zip",data:r.generate(),dataType:"base64",onError:function(){alert("An error occurred, sorry!")},onComplete:function(){s.remove(),s=undefined,window.onbeforeunload=function(){}},swf:c+"media/downloadify.swf",downloadImage:c+"media/download.png",width:84,height:25,transparent:!0}))}var o=b.attr("id").split("-")[1]+" - "+b.data("title"),p=a(".jcarousel ul li img").map(function(){return this.id.split("-")[1]}).get(),q=[],r=new JSZip;console.log("Album name = "+o),console.log("Image IDs  = "+p);if(p.length===0){alert("This album appears to be empty...");return}a(window.body).append(a(g));var s=a("#IZAstatus");s.html(j(i,0,p.length)),window.onbeforeunload=function(){return};for(var t in p){if(!p.hasOwnProperty(t))continue;a("<img />").load(k).error(m).data("imgur-id",p[t]).attr("src","http://imgur.com/download/"+p[t])}};a.ajaxSetup({cache:!0}),a.getScript(c+"js/jszip.js",function(){a.getScript(c+"js/swfobject.js",function(){a.getScript(c+"js/downloadify.min.js",function(){k()})})})}(jQuery);